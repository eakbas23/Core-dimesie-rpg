    <script>
        // --- SPEL DATA ---
        const GAME_DATA = {
            kaizen: { name: 'KAIZEN23', class: 'kaizen' },
            mmz: { name: 'MMZ23', class: 'mmz' },
            bear: { name: 'bEAr23', class: 'bear' },
            outsider: { name: 'DE OUTSIDER', class: 'outsider' },

            outsiderActions: {
                supportPulse: 3,
                debugPing: 2,
                glitchRewind: 1,
                hasArmband: false
            },
            
            warden: { hp: 100 },

            // --- HOOFDSTUKKEN ---
            chapters: {
                // --- NIEUWE MEESLEPENDE PROLOOG ---
                START: {
                    text: `
                    <span class="outsider">SYSTEEM LOG: [eakbas23.nl] - 01:47 AM</span>
                    <br>
                    De nacht is gevallen. De enige lichtbron is het felle blauw van je scherm. Je scrollt door de 'TechRune' gadgets, specifiek op zoek naar de <span class="important">ultieme powerbank</span>.
                    <br><br>
                    <span class="system">WEB ASSISTENT GEVONDEN:</span> bEAr23 (Glitch Support, Online).
                    <br><br>
                    <span class="outsider">Jij:</span> "Hé, bEAr23. Heb je iets dat méér is dan de standaard 50.000 mAh? Ik zoek de échte, verborgen krachtbron."
                    <br><br>
                    <span class="bear">bEAr23:</span> "<span class="bear">Zoeken... Standaard files... Nee. Even kijken in het <span class="important">Archief van de Webshop Core</span>... Wacht. Ik vind een bestand met de naam: <span class="important">OVERCORE_SHARD_CORE_POWER.dat</span>. Dit is verzegeld. Waarom...?</span>"
                    `,
                    choices: [{
                        text: "Zeg tegen bEAr23: 'Open dat bestand. Nu.'",
                        next: "PROLOOG_2"
                    }]
                },

                PROLOOG_2: {
                    text: `
                    <span class="bear">bEAr23:</span> "<span class="bear">Ik zal het proberen. Maar deze code... het voelt alsof er iets terug duwt.</span>"
                    <br><br>
                    De hele website begint te flikkeren. De logo's strekken uit tot scherpe geometrische vormen. Een oorverdovend geluid van statische ruis vult de kamer.
                    <br><br>
                    <span class="bear">bEAr23:</span> "<span class="bear">FOUT! DIT IS GEEN DATA! HET IS EEN BEWUSTZIJN! INLEIDING EXTERNE ENTITEIT GEACTIVEERD! <span class="important">HET ZUIGT ME LEE-</span></span>"
                    <br><br>
                    Een vreemd groen-blauw portaal opent zich op je scherm, rechtstreeks uit de glitch. Je wordt met een onweerstaanbare kracht de digitale dimensie ingezogen en landt met een harde klap.
                    `,
                    choices: [{
                        text: "Hoofdstuk 2: Ontwaking in CentralHub",
                        next: "CENTRALHUB_1"
                    }]
                },

                // --- CENTRAL HUB (Onveranderd) ---
                CENTRALHUB_1: { /* ... vul hier de echte scene data in ... */ 
                    text: `<span class="system">Central Hub inladen... (Dit is een placeholder)</span>`,
                    choices: [{ text: "Ga verder", next: "TECHRUNE_1" }]
                },
                CENTRALHUB_2_A: { /* ... */ },
                CENTRALHUB_2_B: { /* ... */ },
                CENTRALHUB_3: { /* ... */ },
                TECHRUNE_1: { /* ... */
                    text: `<span class="system">Tech Rune inladen... (Dit is een placeholder)</span>`,
                    choices: [{ text: "Kies Stealth Route", next: "TECHRUNE_STEALTH_2" }]
                },
                TECHRUNE_BRUTE_FORCE_2: { /* ... */ },
                TECHRUNE_SPLIT_2: { /* ... */ },

                // --- STEALTH ROUTE UITGEWERKT ---
                TECHRUNE_STEALTH_2: {
                    text: `
                    <span class="kaizen">STEALTH ROUTE: DE DATALEIDINGEN</span>
                    <br>
                    Je kiest voor de tactische aanpak. Kaizen23 leidt jullie door de smalle dataleidingen, waar de lucht naar ozon en verbrande code ruikt.
                    <br><br>
                    <span class="kaizen">Kaizen23:</span> "<span class="kaizen">Stilte. De Cipher Warden heeft een netwerk van 'Sentinel Drones'. Eén fout en we zijn gevonden. Er is hier een verlaten testlab; ik gok dat we daar de Armband vinden.</span>"
                    <br><br>
                    <span class="mmz">Mmz23:</span> "<span class="mmz">Blijf achter me, Outsider. Ik houd de flanken in de gaten.</span>"
                    `,
                    choices: [{
                        text: "Kruip verder door de duistere dataleiding.",
                        next: "TECHRUNE_STEALTH_3_ARMBAK"
                    }]
                },

                TECHRUNE_STEALTH_3_ARMBAK: {
                    text: `
                    <span class="outsider">HET VERBORGEN LAB</span>
                    <br>
                    Het lab is stil. Op een verhoogd platform zie je een gloeiende, minimalistische <span class="important">blauw-oranje Armband</span>.
                    <br><br>
                    <span class="bear">bEAr23:</span> "<span class="bear">Daar is hij! De CoreLink-Armband! Hij is ontworpen om de dimensie-barrière te omzeilen en jou direct met ons te laten communiceren. Pak hem snel.</span>"
                    <br><br>
                    <span class="system">SYSTEM:</span> Je hebt de <span class="important">CORELINK-ARMBAND</span> ontvangen! De Outsider's actieve vaardigheden zijn nu geactiveerd. Dit is jouw rol: <span class="important">Support</span>.
                    `,
                    choices: [{
                        text: "Ga door: Een stroomstoring blokkeert de uitgang.",
                        next: "TECHRUNE_STEALTH_4_PUZZEL"
                    }],
                    onEnter: () => GAME_DATA.outsiderActions.hasArmband = true 
                },
                
                TECHRUNE_STEALTH_4_PUZZEL: {
                    text: `
                    <span class="kaizen">DE STROOMKABEL PUZZEL</span>
                    <br>
                    De uitgang is verzegeld. Een datakabel netwerk is losgeraakt, en de deur vraagt om een exacte stroomfrequentie.
                    <br><br>
                    <span class="kaizen">Kaizen23:</span> "<span class="kaizen">We hebben slechts 5 seconden om de juiste volgorde van de kabels te berekenen, anders gaat het hoofdalarm af. Maar we kunnen hulp gebruiken om sneller te werken, of om het systeem te ontregelen.</span>"
                    <br><br>
                    <span class="outsider">KEUZE:</span> Gebruik je Armband-skills om de kans op succes te vergroten of vertrouw je op de basis?
                    `,
                    choices: [
                        {
                            text: "OPTIE 1: Gebruik **SUPPORT PULSE** op Kaizen23 (+30% Tactiek).",
                            next: "TECHRUNE_STEALTH_5_SUCCES",
                            action: () => useOutsiderAction('supportPulse')
                        },
                         {
                            text: "OPTIE 2: Vertrouw op hun basisberekening (Risico: Hoog)",
                            next: "TECHRUNE_STEALTH_5_SUCCES"
                        },
                        {
                            text: "OPTIE 3: Gebruik **DEBUG PING** op de deur (Korte onderbreking van de beveiliging).",
                            next: "TECHRUNE_STEALTH_5_SUCCES_DEBUG",
                            action: () => useOutsiderAction('debugPing')
                        }
                    ]
                },
                
                TECHRUNE_STEALTH_5_SUCCES: {
                    text: `
                    <span class="system">SUCCES!</span>
                    <br>
                    Kaizen23 plugt de laatste kabel in. De deur ontgrendelt met een zachte klik. Het alarm bleef stil.
                    <br><br>
                    <span class="kaizen">Kaizen23:</span> "<span class="kaizen">Goed werk. De Cipher Warden is in de hal hierboven. Tijd voor de confrontatie.</span>"
                    `,
                    choices: [{
                        text: "Ga door naar de Cipher Warden (Mini-Baas).",
                        next: "TECHRUNE_BAAS_1"
                    }]
                },
                
                TECHRUNE_STEALTH_5_SUCCES_DEBUG: {
                    text: `
                    <span class="system">SUCCES DOOR DEBUG!</span>
                    <br>
                    Je Debug Ping veroorzaakte een fractie van een seconde 'lag' in het beveiligingssysteem. Dat was net genoeg.
                    <br><br>
                    <span class="bear">bEAr23:</span> "<span class="bear">Ha! Je 'Glitch Anomalie' werkt. Nu naar de baas!</span>"
                    `,
                    choices: [{
                        text: "Ga door naar de Cipher Warden (Mini-Baas).",
                        next: "TECHRUNE_BAAS_1"
                    }]
                },
                
                // --- MINI-BAAS GEVECHT (TURN 1) ---
                TECHRUNE_BAAS_1: {
                    text: `
                    <span class="mmz">CONFRONTATIE: DE CIPHER WARDEN</span>
                    <br>
                    Jullie staan voor de Mini-Baas. Hij is een 3 meter hoge, donkere, gepantserde robot, met een rood, dreigend oog in zijn scherm-hoofd.
                    <br><br>
                    <span class="kaizen">Kaizen23:</span> "<span class="kaizen">Hij is te zwaar. Richt op zijn kern, die zichtbaar wordt na zijn aanval. Outsider, houd ons overeind!</span>"
                    <br><br>
                    <span class="system">CIPHER WARDEN:</span> <span class="damage">Activeert Data Sweep aanval!</span> (Schade aan Kaizen & Mmz)
                    <br>
                    <span class="mmz">Mmz23:</span> "<span class="mmz">Oef! Dat deed pijn! Nu is onze beurt!</span>"
                    `,
                    choices: [{
                        text: "AANVAL 1: Kaizen's Precision Shot (15 Schade)",
                        next: "TECHRUNE_BAAS_2",
                        action: () => dealDamage(15) // Herschreven: Geen 'return'
                    }, {
                        text: "AANVAL 2: Mmz's Overload Kick (20 Schade)",
                        next: "TECHRUNE_BAAS_2",
                        action: () => dealDamage(20) // Herschreven: Geen 'return'
                    }, {
                        text: "SUPPORT: Gebruik **SUPPORT PULSE** op Mmz (Extra Schade in de volgende ronde)",
                        next: "TECHRUNE_BAAS_2",
                        action: () => useOutsiderAction('supportPulse') // Herschreven: Directe aanroep
                    }]
                },
                
                // --- MINI-BAAS GEVECHT (TURN 2 - GEVECHTS LOGICA) ---
                TECHRUNE_BAAS_2: {
                    text: `
                    <span class="system">SYSTEM:</span> Je hebt de Cipher Warden geraakt. Zijn HP is nu <span id="warden-hp-dialogue">${GAME_DATA.warden.hp}</span>.
                    <br><br>
                    <span class="kaizen">Kaizen23:</span> "<span class="kaizen">Blijf de druk opvoeren! Hij bereidt zijn volgende aanval voor!</span>"
                    <br><br>
                    <span class="system">CIPHER WARDEN:</span> <span class="damage">Activeert Core Deflect!</span> (Verdedigt de komende aanval!)
                    <br>
                    <span class="outsider">KEUZE:</span> Wat is je volgende commando?
                    `,
                    choices: [{
                        text: "AANVAL 1: Kaizen's Precision Shot (15 Schade) - Wordt geblokkeerd!",
                        next: "TECHRUNE_BAAS_3",
                        action: () => dealDamage(0) 
                    }, {
                        text: "AANVAL 2: Mmz's Overload Kick (20 Schade) - Wordt geblokkeerd!",
                        next: "TECHRUNE_BAAS_3",
                        action: () => dealDamage(0) 
                    }, {
                        text: "SUPPORT: Gebruik **DEBUG PING** op de Warden (Verwijdert de 'Core Deflect' Status)",
                        next: "TECHRUNE_BAAS_3",
                        action: () => useOutsiderAction('debugPing') 
                    }]
                },
                
                // --- MINI-BAAS GEVECHT (TURN 3 - WINNEN/VERLIEZEN) ---
                TECHRUNE_BAAS_3: {
                    text: `
                    <span class="system">SYSTEM:</span> De Warden is nu verdedigd... of is de verdediging door jou <span class="heal">ge-debugged</span>?
                    <br><br>
                    <span class="mmz">Mmz23:</span> "<span class="mmz">Nu! De Deflect is weg!</span>"
                    <br><br>
                    <span class="system">JULLIE AANVAL!</span> Mmz stormt toe en Kaizen vuurt haar Precision Shot af.
                    <br>
                    <span class="system">SYSTEM:</span> <span class="heal">40 SCHADE toegebracht!</span>
                    <br>
                    ${GAME_DATA.warden.hp > 0 ? `<span class="system">DE WARDEN OVERLEEFT!</span>` : `<span class="system">OVERCORE WARDEN VERSLAGEN! De bewaker stort neer en laat de eerste SHARD achter!</span>`}
                    `,
                    choices: [{
                        text: "GEVECHT VOORBIJ: Eerste Shard verzameld! Ga terug naar CentralHub.",
                        next: "CENTRALHUB_1",
                        action: () => {
                             // Controleer of de speler de baas verslagen heeft
                            if (GAME_DATA.warden.hp > 0) {
                                // Zorgt ervoor dat de tekst klopt, zelfs als de speler niet genoeg schade deed
                                GAME_DATA.warden.hp = 0;
                            }
                            GAME_DATA.shards = 1;
                        }
                    }]
                }
            }
        };

        // --- SPEL LOGICA ---

        let currentScene = 'START';
        const dialogueEl = document.getElementById('dialogue');
        const choicesEl = document.getElementById('choices');
        const pulseCount = document.getElementById('support-pulse');
        const debugCount = document.getElementById('debug-ping');
        const rewindCount = document.getElementById('glitch-rewind');
        const wardenHpEl = document.getElementById('warden-hp');
        
        // Functie om schade toe te voegen (vereenvoudigd voor demo)
        function dealDamage(amount) {
            GAME_DATA.warden.hp -= amount;
            if (GAME_DATA.warden.hp < 0) GAME_DATA.warden.hp = 0;
            updateUI();
        }

        function updateUI() {
            const data = GAME_DATA.chapters[currentScene];
            if (!data) return;

            // Voer eenmalige actie uit bij betreden van scene (zoals armband activeren)
            if (data.onEnter && typeof data.onEnter === 'function') {
                data.onEnter();
            }

            // Update Dialogue, inclusief dynamische HP (alleen in gevechtscènes)
            let currentText = data.text;
            // Dit is cruciaal om de HP correct in de dialoog weer te geven
            currentText = currentText.replace('<span id="warden-hp-dialogue">${GAME_DATA.warden.hp}</span>', `<span id="warden-hp-dialogue">${GAME_DATA.warden.hp}</span>`);
            dialogueEl.innerHTML = currentText;

            // Update Choices
            choicesEl.innerHTML = '';
            data.choices.forEach(choice => {
                const button = document.createElement('button');
                button.textContent = choice.text;
                
                let isDisabled = false;
                
                // Controleer op beschikbare skills voordat we de knop renderen
                if (choice.action) {
                    // Dit is een eenvoudige (maar onbetrouwbare) manier om te controleren welk type skill gebruikt wordt
                    // Een betere manier zou zijn om de skillKey direct in het choice object op te slaan
                    
                    if (choice.text.includes('SUPPORT PULSE') && GAME_DATA.outsiderActions.supportPulse <= 0) {
                        isDisabled = true;
                        button.textContent += ` (0x over)`;
                    } else if (choice.text.includes('DEBUG PING') && GAME_DATA.outsiderActions.debugPing <= 0) {
                        isDisabled = true;
                        button.textContent += ` (0x over)`;
                    } else if (choice.text.includes('GLITCH REWIND') && GAME_DATA.outsiderActions.glitchRewind <= 0) {
                        isDisabled = true;
                        button.textContent += ` (0x over)`;
                    }
                }

                button.disabled = isDisabled;
                
                button.onclick = () => {
                    if (choice.action) {
                        choice.action(); // Voer de skill/damage actie uit
                    }
                    goToScene(choice.next);
                };
                
                choicesEl.appendChild(button);
            });

            // Update Outsider & Vijand Stats
            pulseCount.textContent = GAME_DATA.outsiderActions.supportPulse;
            debugCount.textContent = GAME_DATA.outsiderActions.debugPing;
            rewindCount.textContent = GAME_DATA.outsiderActions.glitchRewind;
            wardenHpEl.textContent = GAME_DATA.warden.hp;

            // Scroll naar onderaan om nieuwe tekst te zien
            window.scrollTo(0, document.body.scrollHeight);
        }

        // FUNCTIES VOOR OUTSIDER SKILLS
        function useOutsiderAction(type) {
             if (type === 'supportPulse' && GAME_DATA.outsiderActions.supportPulse > 0) {
                 GAME_DATA.outsiderActions.supportPulse--;
             } else if (type === 'debugPing' && GAME_DATA.outsiderActions.debugPing > 0) {
                 GAME_DATA.outsiderActions.debugPing--;
             } else if (type === 'glitchRewind' && GAME_DATA.outsiderActions.glitchRewind > 0) {
                 GAME_DATA.outsiderActions.glitchRewind--;
             }
        }
        
        function goToScene(sceneKey) {
            currentScene = sceneKey;
            updateUI();
        }

        // Start het spel
        goToScene('START');
    </script>
