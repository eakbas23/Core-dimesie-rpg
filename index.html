<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Core Dimensie RPG - De Glitch</title>
    <style>
        /* CORE DIMENSIE CSS */
        body {
            font-family: 'Consolas', 'Courier New', monospace;
            background-color: #121212;
            color: #E0E0E0;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }
        #game-container {
            width: 90%;
            max-width: 800px;
            background-color: #1E1E1E;
            border: 3px solid #00BFFF; /* Core Blauw */
            box-shadow: 0 0 20px rgba(0, 191, 255, 0.5);
            padding: 25px;
            border-radius: 10px;
        }
        #dialogue {
            min-height: 200px;
            border-bottom: 1px dashed #333;
            margin-bottom: 20px;
            white-space: pre-wrap;
            line-height: 1.6;
        }
        .character-name {
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
            text-transform: uppercase;
        }
        .kaizen { color: #00BFFF; }
        .mmz { color: #00FF7F; }
        .bear { color: #FF4500; }
        .outsider { color: #FFD700; }
        .system { color: #FF00FF; }
        .important { font-weight: bold; color: #FFA500; }
        .damage { color: #FF4500; font-weight: bold;}
        .heal { color: #00FF7F; font-weight: bold;}


        #choices button {
            display: block;
            width: 100%;
            padding: 15px;
            margin-top: 10px;
            background-color: #008CBA;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
            font-size: 1em;
            text-align: left;
        }
        #choices button:disabled {
            background-color: #555;
            cursor: not-allowed;
            color: #aaa;
        }
        #choices button:hover:not(:disabled) {
            background-color: #00BFFF;
            transform: translateY(-2px);
        }
        .stats-panel {
            background-color: #2D2D2D;
            border: 1px solid #444;
            padding: 15px;
            margin-top: 20px;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <h1>üíæ CORE DIMENSIE RPG</h1>
        <hr>
        <div id="dialogue">Laden...</div>
        <div id="choices"></div>

        <div class="stats-panel">
            <h3>‚öôÔ∏è Huidige Status</h3>
            <p>
                **SKILLS (Per Wereld):**<br>
                Support Pulse: <span id="support-pulse">3</span>x | Debug Ping: <span id="debug-ping">2</span>x | Glitch Rewind: <span id="glitch-rewind">1</span>x
            </p>
            <p>
                **VIJAND:** Cipher Warden HP: <span id="warden-hp">100</span>
            </p>
        </div>
    </div>

    <script>
        // --- SPEL DATA ---
        const GAME_DATA = {
            kaizen: { name: 'KAIZEN23', class: 'kaizen' },
            mmz: { name: 'MMZ23', class: 'mmz' },
            bear: { name: 'bEAr23', class: 'bear' },
            outsider: { name: 'DE OUTSIDER', class: 'outsider' },

            outsiderActions: {
                supportPulse: 3,
                debugPing: 2,
                glitchRewind: 1,
                hasArmband: false
            },
            
            warden: { hp: 100 },
            shards: 0, // Nieuwe variabele voor shards

            // --- HOOFDSTUKKEN ---
            chapters: {
                // --- PROLOOG ---
                START: {
                    text: `
                    <span class="outsider">SYSTEEM LOG: [eakbas23.nl] - 01:47 AM</span>
                    <br>
                    De nacht is gevallen. Je zoekt de <span class="important">ultieme powerbank</span>.
                    <br><br>
                    <span class="system">WEB ASSISTENT GEVONDEN:</span> bEAr23 (Glitch Support, Online).
                    <br><br>
                    <span class="outsider">Jij:</span> "H√©, bEAr23. Ik zoek de √©chte, verborgen krachtbron: OVERCORE_SHARD_CORE_POWER.dat."
                    <br><br>
                    <span class="bear">bEAr23:</span> "<span class="bear">Dit is verzegelde data. Waarom...?</span>"
                    `,
                    choices: [{
                        text: "Zeg tegen bEAr23: 'Open dat bestand. Nu.'",
                        next: "PROLOOG_2"
                    }]
                },

                PROLOOG_2: {
                    text: `
                    <span class="bear">bEAr23:</span> "<span class="bear">FOUT! DIT IS GEEN DATA! HET IS EEN BEWUSTZIJN! INLEIDING EXTERNE ENTITEIT GEACTIVEERD! HET ZUIGT ME LEE-</span>"
                    <br><br>
                    Een groen-blauw portaal opent zich. Je wordt de digitale dimensie ingezogen.
                    `,
                    choices: [{
                        text: "Hoofdstuk 2: Ontwaking in CentralHub",
                        next: "CENTRALHUB_1"
                    }]
                },

                // --- CENTRAL HUB (Placeholder) ---
                CENTRALHUB_1: {
                    text: `<span class="system">Central Hub inladen... (Placeholder)</span>`,
                    choices: [{ text: "Ga verder naar Tech Rune", next: "TECHRUNE_1" }]
                },
                TECHRUNE_1: {
                    text: `<span class="system">Tech Rune inladen... (Placeholder)</span>`,
                    choices: [{ text: "Kies Stealth Route", next: "TECHRUNE_STEALTH_2" }]
                },

                // --- STEALTH ROUTE ---
                TECHRUNE_STEALTH_2: {
                    text: `
                    <span class="kaizen">STEALTH ROUTE: DE DATALEIDINGEN</span>
                    <br>
                    Kaizen23 leidt jullie. We zoeken de CoreLink-Armband.
                    `,
                    choices: [{
                        text: "Kruip verder door de duistere dataleiding.",
                        next: "TECHRUNE_STEALTH_3_ARMBAK"
                    }]
                },

                TECHRUNE_STEALTH_3_ARMBAK: {
                    text: `
                    <span class="outsider">HET VERBORGEN LAB</span>
                    <br>
                    Je pakt de gloeiende, minimalistische <span class="important">blauw-oranje Armband</span>.
                    <br><br>
                    <span class="system">SYSTEM:</span> Je hebt de <span class="important">CORELINK-ARMBAND</span> ontvangen! Jouw rol: <span class="important">Support</span>.
                    `,
                    choices: [{
                        text: "Ga door: Een stroomstoring blokkeert de uitgang.",
                        next: "TECHRUNE_STEALTH_4_PUZZEL"
                    }],
                    onEnter: () => GAME_DATA.outsiderActions.hasArmband = true 
                },
                
                TECHRUNE_STEALTH_4_PUZZEL: {
                    text: `
                    <span class="kaizen">DE STROOMKABEL PUZZEL</span>
                    <br>
                    De deur vraagt om een exacte stroomfrequentie. We hebben hulp nodig om sneller te werken.
                    <br><br>
                    <span class="outsider">KEUZE:</span> Gebruik je Armband-skills?
                    `,
                    choices: [
                        {
                            text: "OPTIE 1: Gebruik **SUPPORT PULSE** op Kaizen23 (+30% Tactiek).",
                            next: "TECHRUNE_STEALTH_5_SUCCES",
                            action: () => useOutsiderAction('supportPulse')
                        },
                         {
                            text: "OPTIE 2: Vertrouw op hun basisberekening (Risico: Hoog)",
                            next: "TECHRUNE_STEALTH_5_SUCCES"
                        },
                        {
                            text: "OPTIE 3: Gebruik **DEBUG PING** op de deur (Korte onderbreking van de beveiliging).",
                            next: "TECHRUNE_STEALTH_5_SUCCES_DEBUG",
                            action: () => useOutsiderAction('debugPing')
                        }
                    ]
                },
                
                TECHRUNE_STEALTH_5_SUCCES: {
                    text: `<span class="system">SUCCES!</span> De deur ontgrendelt. Kaizen23: "Tijd voor de confrontatie."`,
                    choices: [{ text: "Ga door naar de Cipher Warden (Mini-Baas).", next: "TECHRUNE_BAAS_1" }]
                },
                
                TECHRUNE_STEALTH_5_SUCCES_DEBUG: {
                    text: `<span class="system">SUCCES DOOR DEBUG!</span> Je Ping veroorzaakte 'lag'. bEAr23: "Ha! Nu naar de baas!"`,
                    choices: [{ text: "Ga door naar de Cipher Warden (Mini-Baas).", next: "TECHRUNE_BAAS_1" }]
                },
                
                // --- MINI-BAAS GEVECHT (TURN 1) ---
                TECHRUNE_BAAS_1: {
                    text: `
                    <span class="mmz">CONFRONTATIE: DE CIPHER WARDEN</span>
                    <br>
                    De Warden is een 3 meter hoge, gepantserde robot.
                    <br><br>
                    <span class="system">CIPHER WARDEN:</span> <span class="damage">Activeert Data Sweep aanval!</span>
                    <br>
                    <span class="mmz">Mmz23:</span> "Oef! Dat deed pijn! Nu is onze beurt!"
                    `,
                    choices: [{
                        text: "AANVAL 1: Kaizen's Precision Shot (15 Schade)",
                        next: "TECHRUNE_BAAS_2",
                        action: () => { dealDamage(15); }
                    }, {
                        text: "AANVAL 2: Mmz's Overload Kick (20 Schade)",
                        next: "TECHRUNE_BAAS_2",
                        action: () => { dealDamage(20); }
                    }, {
                        text: "SUPPORT: Gebruik **SUPPORT PULSE** op Mmz (Extra Schade in de volgende ronde)",
                        next: "TECHRUNE_BAAS_2",
                        action: () => { useOutsiderAction('supportPulse'); }
                    }]
                },
                
                // --- MINI-BAAS GEVECHT (TURN 2) ---
                TECHRUNE_BAAS_2: {
                    text: `
                    <span class="system">SYSTEM:</span> Je hebt de Cipher Warden geraakt. Zijn HP is nu <span id="warden-hp-dialogue">${GAME_DATA.warden.hp}</span>.
                    <br><br>
                    <span class="system">CIPHER WARDEN:</span> <span class="damage">Activeert Core Deflect!</span> (Verdedigt de komende aanval!)
                    <br>
                    <span class="outsider">KEUZE:</span> Wat is je volgende commando?
                    `,
                    choices: [{
                        text: "AANVAL 1: Kaizen's Precision Shot (15 Schade) - Wordt geblokkeerd!",
                        next: "TECHRUNE_BAAS_3",
                        action: () => { dealDamage(0); }
                    }, {
                        text: "AANVAL 2: Mmz's Overload Kick (20 Schade) - Wordt geblokkeerd!",
                        next: "TECHRUNE_BAAS_3",
                        action: () => { dealDamage(0); }
                    }, {
                        text: "SUPPORT: Gebruik **DEBUG PING** op de Warden (Verwijdert de 'Core Deflect' Status)",
                        next: "TECHRUNE_BAAS_3",
                        action: () => { useOutsiderAction('debugPing'); }
                    }]
                },
                
                // --- MINI-BAAS GEVECHT (TURN 3 - Einde) ---
                TECHRUNE_BAAS_3: {
                    text: `
                    <span class="system">SYSTEM:</span> De Warden is nu verdedigd... of is de verdediging door jou <span class="heal">ge-debugged</span>?
                    <br><br>
                    <span class="system">JULLIE AANVAL!</span> <span class="heal">40 SCHADE toegebracht!</span>
                    <br>
                    <span class="system">OVERCORE WARDEN VERSLAGEN! De bewaker stort neer en laat de eerste SHARD achter!</span>
                    `,
                    choices: [{
                        text: "GEVECHT VOORBIJ: Eerste Shard verzameld! Ga terug naar CentralHub.",
                        next: "CENTRALHUB_1",
                        action: () => {
                            GAME_DATA.warden.hp = 0; // Zorg dat HP op 0 staat
                            GAME_DATA.shards = 1; // Shard ontvangen
                        }
                    }]
                }
            }
        };

        // --- GLOBALE VARIABELEN ---
        let currentScene = 'START';
        let dialogueEl, choicesEl, pulseCount, debugCount, rewindCount, wardenHpEl;

        // --- SPEL LOGICA FUNCTIES ---

        function dealDamage(amount) {
            GAME_DATA.warden.hp -= amount;
            if (GAME_DATA.warden.hp < 0) GAME_DATA.warden.hp = 0;
            // updateUI wordt automatisch aangeroepen door goToScene na de action
        }

        function useOutsiderAction(type) {
             if (type === 'supportPulse' && GAME_DATA.outsiderActions.supportPulse > 0) {
                 GAME_DATA.outsiderActions.supportPulse--;
             } else if (type === 'debugPing' && GAME_DATA.outsiderActions.debugPing > 0) {
                 GAME_DATA.outsiderActions.debugPing--;
             } else if (type === 'glitchRewind' && GAME_DATA.outsiderActions.glitchRewind > 0) {
                 GAME_DATA.outsiderActions.glitchRewind--;
             }
             // updateUI wordt automatisch aangeroepen door goToScene na de action
        }
        
        function goToScene(sceneKey) {
            currentScene = sceneKey;
            updateUI();
        }

        function updateUI() {
            // Controleer of de elementen bestaan (dit zou goed moeten zijn na DOMContentLoaded)
            if (!dialogueEl || !choicesEl) return; 

            const data = GAME_DATA.chapters[currentScene];
            if (!data) {
                dialogueEl.innerHTML = `<span class="system">FOUT: SCENE ${currentScene} NIET GEVONDEN.</span>`;
                choicesEl.innerHTML = '';
                return;
            }

            // Voer eenmalige actie uit bij betreden van scene
            if (data.onEnter && typeof data.onEnter === 'function') {
                data.onEnter();
            }

            // Update Dialogue
            let currentText = data.text;
            
            // Vervang de dynamische HP-placeholder
            if (currentText.includes('${GAME_DATA.warden.hp}')) {
                // Correcte vervanging van de template string
                currentText = currentText.replace('${GAME_DATA.warden.hp}', GAME_DATA.warden.hp);
            }
            
            dialogueEl.innerHTML = currentText;


            // Update Choices
            choicesEl.innerHTML = '';
            data.choices.forEach(choice => {
                const button = document.createElement('button');
                button.textContent = choice.text;
                
                let isDisabled = false;
                
                // Controleer op beschikbare skills (maakt knop disabled)
                if (choice.action) {
                    if (choice.text.includes('SUPPORT PULSE') && GAME_DATA.outsiderActions.supportPulse <= 0) {
                        isDisabled = true;
                        button.textContent += ` (0x over)`;
                    } else if (choice.text.includes('DEBUG PING') && GAME_DATA.outsiderActions.debugPing <= 0) {
                        isDisabled = true;
                        button.textContent += ` (0x over)`;
                    } else if (choice.text.includes('GLITCH REWIND') && GAME_DATA.outsiderActions.glitchRewind <= 0) {
                        isDisabled = true;
                        button.textContent += ` (0x over)`;
                    }
                }

                button.disabled = isDisabled;
                
                // Belangrijk: De klik-handler roept eerst de action() aan en gaat dan naar de scene
                button.onclick = () => {
                    if (choice.action) {
                        choice.action(); 
                    }
                    goToScene(choice.next);
                };
                
                choicesEl.appendChild(button);
            });

            // Update Outsider & Vijand Stats
            if (pulseCount && debugCount && rewindCount && wardenHpEl) {
                pulseCount.textContent = GAME_DATA.outsiderActions.supportPulse;
                debugCount.textContent = GAME_DATA.outsiderActions.debugPing;
                rewindCount.textContent = GAME_DATA.outsiderActions.glitchRewind;
                wardenHpEl.textContent = GAME_DATA.warden.hp;
            }

            // Scroll naar onderaan
            window.scrollTo(0, document.body.scrollHeight);
        }
        
        // Zorg ervoor dat het spel pas start nadat de DOM volledig geladen is
        document.addEventListener('DOMContentLoaded', () => {
            // Wijs de elementen toe NADAT de DOM is geladen
            dialogueEl = document.getElementById('dialogue');
            choicesEl = document.getElementById('choices');
            pulseCount = document.getElementById('support-pulse');
            debugCount = document.getElementById('debug-ping');
            rewindCount = document.getElementById('glitch-rewind');
            wardenHpEl = document.getElementById('warden-hp');
            
            // Start het spel
            goToScene('START');
        });

    </script>
</body>
</html>
